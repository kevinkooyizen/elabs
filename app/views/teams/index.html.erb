<div class="teams-container">

  <div class="teams-search">
    <h5>SEARCH TEAMS</h5>
    <div class="search-form">
      <% @params||={} %>
      <%= form_for :teams_search, url: teams_search_path, method: :get do |f| %>
          <%= f.label :name %>
          <%= f.text_field :name, value: @params.dig(:name) %>
          <br>
          <%= f.label :country %>
          <%= f.text_field :country, value: @params.dig(:country) %>
          <br>
          <br>
          <%= f.submit 'Search', class: 'btn btn-default' %>
      <% end %>
    </div>
  </div>

  <div class="teams-index">
    <% @teams.each do |team| %>

      <div class="team-card">
        <h6 class="team-id">Team id: <%= team.dota2_team_id %> <br></h6>
        <h6 class="team-name">Name: <%= link_to "#{team.name}", team_path(team) %> <br></h6>
        <h6 class="team-rating">Rating: <%= team.rating %><br> </h6>
        <h6 class="team-winrate">
          Winrate:
          <% if !team.winrate.nil? %>
            <%= team.winrate %>%
          <% else %>
            Insufficient data.
          <% end %>
          <br>
        </h6>
        <h6 class="team-roster">Roster: <br></h6>
        <!-- TEAM ROSTER -->
        <% team.roster.each do |roster| %>
          <% if roster.present? %>
            <% if !(JSON.parse open("https://api.opendota.com/api/players/#{roster}").read)["profile"].nil? %>
              <% if !(JSON.parse open("https://api.opendota.com/api/players/#{roster}").read)["profile"]["name"].nil? %>
                <%= (JSON.parse open("https://api.opendota.com/api/players/#{roster}").read)["profile"]["name"] %> <br>
              <% else %>
                <%= (JSON.parse open("https://api.opendota.com/api/players/#{roster}").read)["profile"]["personaname"] %> <br>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
      </div>
  </div>

</div>

<div class="pagination">
  <%= paginate @teams, window: 2 %>
</div>
